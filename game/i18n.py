LANGUAGE_ORDER = ["zh", "en", "ja"]
LANGUAGE_LABELS = {
    "zh": "中文",
    "en": "English",
    "ja": "日本語",
}

STRINGS = {
    "zh": {
        "app.title": "俄罗斯方块 - Advanced Tetris",
        "menu.title": "俄罗斯方块",
        "menu.start": "开始游戏",
        "menu.high_scores": "高分榜",
        "menu.statistics": "统计数据",
        "menu.settings": "设置",
        "menu.exit": "退出",
        "menu.hint.up_down": "使用 ↑↓ 选择菜单",
        "menu.hint.enter": "按 ENTER 确认",
        "menu.hint.esc": "按 ESC 退出游戏",
        "settings.title": "游戏设置",
        "settings.difficulty": "难度",
        "settings.sound": "音效",
        "settings.music": "音乐",
        "settings.ghost": "幽灵方块",
        "settings.theme": "主题",
        "settings.language": "语言",
        "settings.reset": "重置设置",
        "settings.back": "返回",
        "settings.hint.up_down": "使用 ↑↓ 选择设置",
        "settings.hint.left_right": "使用 ←→ 调整设置",
        "settings.hint.enter": "按 ENTER 确认",
        "settings.hint.esc": "按 ESC 返回菜单",
        "toggle.on": "开启",
        "toggle.off": "关闭",
        "difficulty.EASY": "简单",
        "difficulty.MEDIUM": "普通",
        "difficulty.HARD": "困难",
        "difficulty.EXPERT": "专家",
        "theme.CLASSIC": "经典",
        "theme.NEON": "霓虹",
        "theme.PASTEL": "柔彩",
        "sidebar.next": "下一个:",
        "sidebar.score": "分数",
        "sidebar.level": "等级",
        "sidebar.lines": "行数",
        "sidebar.difficulty": "难度",
        "sidebar.controls": "控制:",
        "controls.left_right": "← → 移动",
        "controls.rotate": "↑ 旋转",
        "controls.soft_drop": "↓ 软降",
        "controls.hard_drop": "空格 硬降",
        "controls.pause": "P 暂停",
        "controls.menu": "ESC 菜单",
        "pause.title": "游戏暂停",
        "pause.resume": "按 P 继续游戏",
        "game_over.title": "游戏结束",
        "game_over.final_score": "最终分数",
        "game_over.continue": "按 SPACE 继续",
        "game_over.menu": "按 ESC 返回菜单",
        "high_scores.title": "高分榜",
        "high_scores.rank": "排名",
        "high_scores.player": "玩家",
        "high_scores.score": "分数",
        "high_scores.level": "等级",
        "high_scores.lines": "行数",
        "high_scores.date": "日期",
        "statistics.title": "游戏统计",
        "statistics.total_games": "总游戏次数",
        "statistics.total_time": "总游戏时间",
        "statistics.total_lines": "总清除行数",
        "statistics.total_score": "总得分",
        "statistics.highest_score": "最高分数",
        "statistics.highest_level": "最高等级",
        "statistics.most_lines": "单局最多行数",
        "statistics.average_score": "平均分数",
        "statistics.average_lines": "平均行数",
        "statistics.average_session": "平均游戏时长",
        "statistics.difficulty_distribution": "游戏难度分布:",
        "statistics.games_suffix": "场",
        "high_score_entry.title": "恭喜！新高分！",
        "high_score_entry.score": "分数",
        "high_score_entry.prompt": "请输入你的名字:",
        "high_score_entry.hint": "按 ENTER 确认, ESC 取消",
        "default_player_name": "匿名玩家",
    },
    "en": {
        "app.title": "Advanced Tetris",
        "menu.title": "Tetris",
        "menu.start": "Start",
        "menu.high_scores": "High Scores",
        "menu.statistics": "Statistics",
        "menu.settings": "Settings",
        "menu.exit": "Exit",
        "menu.hint.up_down": "Use ↑↓ to navigate",
        "menu.hint.enter": "Press ENTER to select",
        "menu.hint.esc": "Press ESC to quit",
        "settings.title": "Settings",
        "settings.difficulty": "Difficulty",
        "settings.sound": "Sound",
        "settings.music": "Music",
        "settings.ghost": "Ghost Piece",
        "settings.theme": "Theme",
        "settings.language": "Language",
        "settings.reset": "Reset",
        "settings.back": "Back",
        "settings.hint.up_down": "Use ↑↓ to navigate",
        "settings.hint.left_right": "Use ←→ to adjust",
        "settings.hint.enter": "Press ENTER to confirm",
        "settings.hint.esc": "Press ESC to return",
        "toggle.on": "On",
        "toggle.off": "Off",
        "difficulty.EASY": "Easy",
        "difficulty.MEDIUM": "Normal",
        "difficulty.HARD": "Hard",
        "difficulty.EXPERT": "Expert",
        "theme.CLASSIC": "Classic",
        "theme.NEON": "Neon",
        "theme.PASTEL": "Pastel",
        "sidebar.next": "Next:",
        "sidebar.score": "Score",
        "sidebar.level": "Level",
        "sidebar.lines": "Lines",
        "sidebar.difficulty": "Difficulty",
        "sidebar.controls": "Controls:",
        "controls.left_right": "← → Move",
        "controls.rotate": "↑ Rotate",
        "controls.soft_drop": "↓ Soft drop",
        "controls.hard_drop": "Space Hard drop",
        "controls.pause": "P Pause",
        "controls.menu": "ESC Menu",
        "pause.title": "Paused",
        "pause.resume": "Press P to resume",
        "game_over.title": "Game Over",
        "game_over.final_score": "Final Score",
        "game_over.continue": "Press SPACE to continue",
        "game_over.menu": "Press ESC for menu",
        "high_scores.title": "High Scores",
        "high_scores.rank": "Rank",
        "high_scores.player": "Player",
        "high_scores.score": "Score",
        "high_scores.level": "Level",
        "high_scores.lines": "Lines",
        "high_scores.date": "Date",
        "statistics.title": "Statistics",
        "statistics.total_games": "Total Games",
        "statistics.total_time": "Total Play Time",
        "statistics.total_lines": "Total Lines",
        "statistics.total_score": "Total Score",
        "statistics.highest_score": "Highest Score",
        "statistics.highest_level": "Highest Level",
        "statistics.most_lines": "Most Lines",
        "statistics.average_score": "Average Score",
        "statistics.average_lines": "Average Lines",
        "statistics.average_session": "Avg Session",
        "statistics.difficulty_distribution": "Difficulty Distribution:",
        "statistics.games_suffix": "games",
        "high_score_entry.title": "New High Score!",
        "high_score_entry.score": "Score",
        "high_score_entry.prompt": "Enter your name:",
        "high_score_entry.hint": "Press ENTER to confirm, ESC to cancel",
        "default_player_name": "Anonymous",
    },
    "ja": {
        "app.title": "テトリス - Advanced Tetris",
        "menu.title": "テトリス",
        "menu.start": "スタート",
        "menu.high_scores": "ハイスコア",
        "menu.statistics": "統計",
        "menu.settings": "設定",
        "menu.exit": "終了",
        "menu.hint.up_down": "↑↓で選択",
        "menu.hint.enter": "ENTERで決定",
        "menu.hint.esc": "ESCで終了",
        "settings.title": "設定",
        "settings.difficulty": "難易度",
        "settings.sound": "効果音",
        "settings.music": "音楽",
        "settings.ghost": "ゴースト",
        "settings.theme": "テーマ",
        "settings.language": "言語",
        "settings.reset": "リセット",
        "settings.back": "戻る",
        "settings.hint.up_down": "↑↓で選択",
        "settings.hint.left_right": "←→で調整",
        "settings.hint.enter": "ENTERで決定",
        "settings.hint.esc": "ESCで戻る",
        "toggle.on": "オン",
        "toggle.off": "オフ",
        "difficulty.EASY": "かんたん",
        "difficulty.MEDIUM": "ふつう",
        "difficulty.HARD": "むずかしい",
        "difficulty.EXPERT": "エキスパート",
        "theme.CLASSIC": "クラシック",
        "theme.NEON": "ネオン",
        "theme.PASTEL": "パステル",
        "sidebar.next": "次:",
        "sidebar.score": "スコア",
        "sidebar.level": "レベル",
        "sidebar.lines": "ライン",
        "sidebar.difficulty": "難易度",
        "sidebar.controls": "操作:",
        "controls.left_right": "← → 移動",
        "controls.rotate": "↑ 回転",
        "controls.soft_drop": "↓ ソフトドロップ",
        "controls.hard_drop": "Space ハードドロップ",
        "controls.pause": "P 一時停止",
        "controls.menu": "ESC メニュー",
        "pause.title": "一時停止",
        "pause.resume": "Pで再開",
        "game_over.title": "ゲームオーバー",
        "game_over.final_score": "最終スコア",
        "game_over.continue": "SPACEで続行",
        "game_over.menu": "ESCでメニュー",
        "high_scores.title": "ハイスコア",
        "high_scores.rank": "順位",
        "high_scores.player": "プレイヤー",
        "high_scores.score": "スコア",
        "high_scores.level": "レベル",
        "high_scores.lines": "ライン",
        "high_scores.date": "日付",
        "statistics.title": "統計",
        "statistics.total_games": "総プレイ回数",
        "statistics.total_time": "総プレイ時間",
        "statistics.total_lines": "総ライン数",
        "statistics.total_score": "総スコア",
        "statistics.highest_score": "最高スコア",
        "statistics.highest_level": "最高レベル",
        "statistics.most_lines": "最大ライン数",
        "statistics.average_score": "平均スコア",
        "statistics.average_lines": "平均ライン",
        "statistics.average_session": "平均時間",
        "statistics.difficulty_distribution": "難易度分布:",
        "statistics.games_suffix": "回",
        "high_score_entry.title": "新記録！",
        "high_score_entry.score": "スコア",
        "high_score_entry.prompt": "名前を入力:",
        "high_score_entry.hint": "ENTERで決定, ESCで取消",
        "default_player_name": "匿名",
    },
}


def t(lang: str, key: str, **kwargs) -> str:
    language = lang if lang in STRINGS else "en"
    value = STRINGS.get(language, {}).get(key, STRINGS["en"].get(key, key))
    return value.format(**kwargs) if kwargs else value


def format_time(lang: str, seconds: float) -> str:
    secs = int(seconds)
    if lang == "en":
        if secs < 60:
            return f"{secs}s"
        if secs < 3600:
            minutes = secs // 60
            rem = secs % 60
            return f"{minutes}m {rem}s"
        hours = secs // 3600
        minutes = (secs % 3600) // 60
        return f"{hours}h {minutes}m"
    if lang == "ja":
        if secs < 60:
            return f"{secs}秒"
        if secs < 3600:
            minutes = secs // 60
            rem = secs % 60
            return f"{minutes}分{rem}秒"
        hours = secs // 3600
        minutes = (secs % 3600) // 60
        return f"{hours}時間{minutes}分"

    if secs < 60:
        return f"{secs}秒"
    if secs < 3600:
        minutes = secs // 60
        rem = secs % 60
        return f"{minutes}分{rem}秒"
    hours = secs // 3600
    minutes = (secs % 3600) // 60
    return f"{hours}小时{minutes}分钟"


def difficulty_label(lang: str, difficulty: str) -> str:
    return t(lang, f"difficulty.{difficulty}")


def theme_label(lang: str, theme: str) -> str:
    return t(lang, f"theme.{theme}")
